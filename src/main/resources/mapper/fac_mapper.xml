<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>

<mapper namespace="com.tmtm.fac.FacDAO">

	<select id="facList" resultType="fac">
		SELECT * FROM file f , fac_state fs ,fac f2 
			WHERE f.file_sort_num =4
			AND f2.fac_state = fs.fac_state_num
			AND f.all_num = f2.fac_num
	</select>
	
	<select id="resCnt" resultType="int">
		SELECT COUNT(*)  FROM fac_book fb 
			WHERE #{param1} BETWEEN fb.book_start AND book_end;
	</select>
	
	<select id="modFac" resultType="fac">
		SELECT fac_name FROM fac WHERE fac_num = #{param1}
	</select>
	

	
	<select id="select" resultType="fac">
		SELECT fac_name,fac_num FROM fac
	</select>
	
	
	
	<select id="book" resultType="fac">
		SELECT book_num FROM fac_book
	</select>
	
	<select id="part" resultType="fac">
		SELECT * FROM departure
	</select>
	
	<select id="team" resultType="fac">
		SELECT t.team_num ,t.team_name FROM departure d ,team t
			WHERE t.dep_num = #{param1} 
			AND t.dep_num = d.dep_num	 
	</select>

	<select id="emp" resultType="fac">
		SELECT * FROM employee e, team t, departure d 
		WHERE e.team_num = #{param1} 
		AND t.dep_num = d.dep_num
		AND e.team_num = t.team_num
	</select>
	
	<select id="teamList" resultType="fac">
		SELECT * FROM team WHERE dep_num=#{param1} 
	</select>
	
	
	
	<insert id="regList" parameterType="fac"
		useGeneratedKeys="true" keyColumn="book_num" keyProperty="book_num">
		INSERT into fac_book (fac_num,emp_num, book_start, book_end, act)
				values (#{fac_num}, #{emp_num}, #{book_start}, #{book_end}, 1)
	</insert> 
	
	<insert id="bookMem">
		INSERT INTO fac_book_league (book_num, emp_num)
			VALUES (#{param1}, #{param2})
	</insert>
	
	<select id="bookList" resultType="fac">
		SELECT * FROM fac_book fb, fac f 
		WHERE fb.fac_num = f.fac_num
		AND fb.act = 1
	</select>
	
	<select id="detail" resultType="fac">
		SELECT * FROM fac_book WHERE emp_num = #{param1}
	</select>
	
	<select id="myBook" resultType="fac" parameterType="fac">
		SELECT * FROM fac_book fb 
			WHERE book_start BETWEEN #{book_start} AND #{book_end}
			AND emp_num = #{emp_num}
	</select>
	
	
</mapper>